<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="本博文主要是在学习 CS231n: Convolutional Neural Networks for Visual Recognition Spring 2017 Lecture 3: Loss Functions and Optimization 之后的总结。
问题描述Suppose: 3 tr">
    

    <!--Author-->
    
        <meta name="author" content="Robert Lexis">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Loss functions 推导及理解"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="This is Robert Lexis."/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Loss functions 推导及理解 - This is Robert Lexis.</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2018/04/12/Loss-functions-推导及理解/">
                Loss functions 推导及理解
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2018-04-12</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <p>本博文主要是在学习 <a href="http://cs231n.stanford.edu/2017/" target="_blank" rel="external">CS231n: Convolutional Neural Networks for Visual Recognition Spring 2017</a> Lecture 3: Loss Functions and Optimization 之后的总结。</p>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p><img src="" alt="problem"><br>Suppose: 3 training examples, 3 classes. With some \(W\) the scores \( f(x, W) = Wx\) are:<br>损失函数告诉我们目前模型性能的好坏（A loss function tells how<br>good our current classifier is）。<br>Loss function takes in the \(W\), looks at the scores, then tell us how bad quantitatively the \(W\) is.<br>Optimizer comes up a procedure for searching through the space of all possible \(Ws\) to get the least bad W.<br>给定数据集 \(\lbrace (x_i, y_i) \rbrace_{i=1}^N\)，其中 \(x_i\) 是图片，\(y_i\) 是一个整数标签，在整个数据集上损失是：<br>$$<br>L = \frac{1}{N} \sum_i L_i(f(x_i, W), y_i)<br>$$</p>
<h3 id="Multiclass-SVM-loss"><a href="#Multiclass-SVM-loss" class="headerlink" title="Multiclass SVM loss"></a>Multiclass SVM loss</h3><p>$$<br>\begin{split}<br>L_i &amp; = \sum_{j \not= y_i} \begin{cases}<br>    0 &amp; s_{y_i} &gt; s_j + 1 \\\<br>    s_j - s_{y_i} + 1 &amp; otherwise<br>    \end{cases} \\\<br>    &amp; = \sum_{j \not= y_i} max(0, s_j - s_{y_i} + 1)<br>\end{split}<br>$$</p>
<p>对一个样本\(i\)而言，我们可以得到其在各个类别上的 score，如上图所示，<br>仅在不是真实标签类别\(y_i\)的其他类别上\(j\)上计算损失，仅当其他类别上的 score \(s_j\) 加上一个 safety margin值之后还小于真实类别上的 score \(s_{y_i}\)时，损失才为0。即不仅仅要求真实类别score \(s_{y_i}\) 大于其他类别score \(s_j}\)，而且更进一步要求优化器使得前者大于后者加上一个safety margin。<br>在 otherwise 分支，\(s_j\) 比 \(s_{y_i}\) 大的值再加上safety margin就是损失值。<br>$$<br>HingeLoss_{i, j} = max(0, s_j - s_{y_i} + 1)<br>$$<br>作为 \(s_{y_i}\) 的函数斜率为 -1，必过点 \((s_j + 1, 0)\)。<br><img src="" alt="hinge_loss"></p>
<p><img src="" alt="losses"><br>$$<br>L = (2.9 + 0 + 12.9) / 3 = 5.27<br>$$</p>
<h5 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h5><ul>
<li>What happens to loss if car scores change a bit ?<br>  The loss will not change.<br>  这说明 SVM loss 关心的仅仅是让真实标签类别的 score 比其他类别的 score 大 1。</li>
<li>what is the min/max possible loss?<br>  0/infinity</li>
<li>At initialization W is small so all s ≈ 0. What is the loss?<br>  number of classes minus one<br>  这一点在 debug 时是很有用的。在我们尚未进行训练之前，我们可以思考一下此时的预期损失。</li>
<li>What if the sum was over all classes (including \(j = y_i\))?<br>  The loss will increase exactly by one.训练结果不会变，会获得同一个的分类器。但是损失的最小值不再是 0，而是1。</li>
<li>What if we used mean instead of sum?<br>  Just rescale the whole loss function by a constant (number of classes minus one). 训练结果不会变，会获得同一个的分类器。</li>
<li>What if we used \( L_i = \sum_{j \not= y_i} max(0, s_j - s_{y_i} + 1)^2 \) ?<br>  现在我们有了一个完全不同的 loss function，squared hinge loss，<strong>不同损失函数对分类器犯下的不同错误的关注点不一样，也就是说，分类器会犯下不同错误，不同的损失函数对这些不同错误的关注程度不一致。</strong> hinge loss 不在乎 score 的错误程度是很错误还是一般错误，而 squared hinge loss 会着重关注那些偏得离谱的错误，因为他们的 wrong 会变成 squared wrong。对于 hinge loss 来说，同等看待，让一个很错误的样本预测结果变得不太错误了，和让一个不太错误的样本预测结果变得更加不太错误，比如，\(4-&gt;3\) 与 \(3-&gt;2\)，而对于 squared hinge loss 来说，<br>  (16-&gt;9) 要比 \(9-&gt;4\) loss 降低幅度要大，但是分类的 accuracy 并没有变化。</li>
</ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/DL/">#DL</a>
        </div>
    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This is Robert Lexis (FengCun Li). To see the world, things dangerous to come to, to see behind walls, to draw closer, to find each other and to feel. That is the purpose of LIFE.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2018/08/26/YOLO/">YOLO</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/08/26/非最大值抑制/">非最大值抑制</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/08/26/目标定位-vs-目标检测/">目标定位 vs 目标检测</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/08/13/消失的梯度/">消失的梯度</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/RobertLexis">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:robert_lexis@163.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Robert Lexis Loves Wenny
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>